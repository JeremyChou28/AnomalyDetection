------------ Options -------------
batch_size: 16384
d_channel: 4
d_ff: 1024
d_model: 512
data_path: ./processed_dataset
dataset: AD
dropout: 0.1
e_layers: 3
input_c: 84
k: 0
lr: 0.001
mode: scratch
model_name: ours
model_save_path: checkpoints
n_heads: 8
num_epochs: 100
output_c: 84
seed: 2023
win_size: 1
-------------- End ----------------
train_loader len: 54
val_loader len: 14
test_loader len: 23
======================TRAIN MODE======================
Epoch: 1 cost time: 21.510775566101074
Epoch: 1, Steps: 54 | Train Loss: 5045.0950702 Vali Loss: 4655.7106585 
Validation loss decreased (inf --> 4655.710658).  Saving model ...
Epoch: 2 cost time: 17.466458797454834
Epoch: 2, Steps: 54 | Train Loss: 4237.4534686 Vali Loss: 3735.7069964 
Validation loss decreased (4655.710658 --> 3735.706996).  Saving model ...
Epoch: 3 cost time: 17.069653749465942
Epoch: 3, Steps: 54 | Train Loss: 3291.1259133 Vali Loss: 2772.1672886 
Validation loss decreased (3735.706996 --> 2772.167289).  Saving model ...
Epoch: 4 cost time: 17.001725673675537
Epoch: 4, Steps: 54 | Train Loss: 2366.6606106 Vali Loss: 1866.2670027 
Validation loss decreased (2772.167289 --> 1866.267003).  Saving model ...
Epoch: 5 cost time: 16.91783118247986
Epoch: 5, Steps: 54 | Train Loss: 1547.0942451 Vali Loss: 1676.4061541 
Validation loss decreased (1866.267003 --> 1676.406154).  Saving model ...
Epoch: 6 cost time: 16.812495946884155
Epoch: 6, Steps: 54 | Train Loss: 1029.6170462 Vali Loss: 685.9741124 
Validation loss decreased (1676.406154 --> 685.974112).  Saving model ...
Epoch: 7 cost time: 16.688188552856445
Epoch: 7, Steps: 54 | Train Loss: 557.4702527 Vali Loss: 373.8514230 
Validation loss decreased (685.974112 --> 373.851423).  Saving model ...
Epoch: 8 cost time: 17.19566059112549
Epoch: 8, Steps: 54 | Train Loss: 616.4965928 Vali Loss: 247.7459379 
Validation loss decreased (373.851423 --> 247.745938).  Saving model ...
Epoch: 9 cost time: 16.555065155029297
Epoch: 9, Steps: 54 | Train Loss: 236.9715472 Vali Loss: 128.1772270 
Validation loss decreased (247.745938 --> 128.177227).  Saving model ...
Epoch: 10 cost time: 17.150381326675415
Epoch: 10, Steps: 54 | Train Loss: 138.0721468 Vali Loss: 71.7502567 
Validation loss decreased (128.177227 --> 71.750257).  Saving model ...
Epoch: 11 cost time: 16.760324239730835
Epoch: 11, Steps: 54 | Train Loss: 90.2293219 Vali Loss: 44.4886014 
Validation loss decreased (71.750257 --> 44.488601).  Saving model ...
Epoch: 12 cost time: 17.107330799102783
Epoch: 12, Steps: 54 | Train Loss: 63.5445933 Vali Loss: 27.5828694 
Validation loss decreased (44.488601 --> 27.582869).  Saving model ...
Epoch: 13 cost time: 16.739560842514038
Epoch: 13, Steps: 54 | Train Loss: 47.2458331 Vali Loss: 19.7962570 
Validation loss decreased (27.582869 --> 19.796257).  Saving model ...
Epoch: 14 cost time: 17.3042950630188
Epoch: 14, Steps: 54 | Train Loss: 38.4551191 Vali Loss: 15.2499621 
Validation loss decreased (19.796257 --> 15.249962).  Saving model ...
Epoch: 15 cost time: 16.825626611709595
Epoch: 15, Steps: 54 | Train Loss: 32.0908015 Vali Loss: 12.6478290 
Validation loss decreased (15.249962 --> 12.647829).  Saving model ...
Epoch: 16 cost time: 17.335777044296265
Epoch: 16, Steps: 54 | Train Loss: 28.1479571 Vali Loss: 10.7000466 
Validation loss decreased (12.647829 --> 10.700047).  Saving model ...
Epoch: 17 cost time: 17.33977723121643
Epoch: 17, Steps: 54 | Train Loss: 24.8923157 Vali Loss: 11.6822764 
EarlyStopping counter: 1 out of 7
Epoch: 18 cost time: 17.09056830406189
Epoch: 18, Steps: 54 | Train Loss: 22.8222231 Vali Loss: 9.7215894 
Validation loss decreased (10.700047 --> 9.721589).  Saving model ...
Epoch: 19 cost time: 16.998481512069702
Epoch: 19, Steps: 54 | Train Loss: 21.0549765 Vali Loss: 9.2497427 
Validation loss decreased (9.721589 --> 9.249743).  Saving model ...
Epoch: 20 cost time: 17.31972908973694
Epoch: 20, Steps: 54 | Train Loss: 19.1929157 Vali Loss: 8.7415558 
Validation loss decreased (9.249743 --> 8.741556).  Saving model ...
Epoch: 21 cost time: 16.72008466720581
Epoch: 21, Steps: 54 | Train Loss: 17.8429814 Vali Loss: 7.9589762 
Validation loss decreased (8.741556 --> 7.958976).  Saving model ...
Epoch: 22 cost time: 17.213417530059814
Epoch: 22, Steps: 54 | Train Loss: 17.3307945 Vali Loss: 8.4337736 
EarlyStopping counter: 1 out of 7
Epoch: 23 cost time: 16.728996992111206
Epoch: 23, Steps: 54 | Train Loss: 16.8095330 Vali Loss: 8.3720138 
EarlyStopping counter: 2 out of 7
Epoch: 24 cost time: 16.889992713928223
Epoch: 24, Steps: 54 | Train Loss: 16.1050959 Vali Loss: 8.0893296 
EarlyStopping counter: 3 out of 7
Epoch: 25 cost time: 16.963923692703247
Epoch: 25, Steps: 54 | Train Loss: 15.5600635 Vali Loss: 11.3641539 
EarlyStopping counter: 4 out of 7
Epoch: 26 cost time: 16.514297008514404
Epoch: 26, Steps: 54 | Train Loss: 892.2206445 Vali Loss: 63.8827087 
EarlyStopping counter: 5 out of 7
Epoch: 27 cost time: 17.193883419036865
Epoch: 27, Steps: 54 | Train Loss: 132.2808478 Vali Loss: 28.9723565 
EarlyStopping counter: 6 out of 7
Epoch: 28 cost time: 16.57402992248535
Epoch: 28, Steps: 54 | Train Loss: 87.8547516 Vali Loss: 22.6118962 
EarlyStopping counter: 7 out of 7
Early stopping
Training finished!
prediction:  (366275, 84)
groundtruth:  (366275, 84)
MSE: 8.786661148071289, MAE: 1.9482934474945068
Testing finished!
Spend Time:  610.7888929843903
