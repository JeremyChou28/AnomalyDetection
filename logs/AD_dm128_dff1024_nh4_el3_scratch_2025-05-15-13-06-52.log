------------ Options -------------
batch_size: 16384
d_channel: 8
d_ff: 1024
d_model: 128
data_path: ./processed_dataset
dataset: AD
dropout: 0.1
e_layers: 3
input_c: 84
k: 0
lr: 0.001
mode: scratch
model_name: ours
model_save_path: checkpoints
n_heads: 4
num_epochs: 100
output_c: 84
seed: 2023
win_size: 1
-------------- End ----------------
train_loader len: 54
val_loader len: 14
test_loader len: 23
======================TRAIN MODE======================
Epoch: 1 cost time: 18.380692720413208
Epoch: 1, Steps: 54 | Train Loss: 5142.5358163 Vali Loss: 4885.0547921 
Validation loss decreased (inf --> 4885.054792).  Saving model ...
Epoch: 2 cost time: 16.187917232513428
Epoch: 2, Steps: 54 | Train Loss: 4603.2555700 Vali Loss: 4248.8301828 
Validation loss decreased (4885.054792 --> 4248.830183).  Saving model ...
Epoch: 3 cost time: 15.927266597747803
Epoch: 3, Steps: 54 | Train Loss: 3911.0331127 Vali Loss: 3511.7770996 
Validation loss decreased (4248.830183 --> 3511.777100).  Saving model ...
Epoch: 4 cost time: 16.106580018997192
Epoch: 4, Steps: 54 | Train Loss: 3175.4096770 Vali Loss: 2779.7488665 
Validation loss decreased (3511.777100 --> 2779.748866).  Saving model ...
Epoch: 5 cost time: 17.018696069717407
Epoch: 5, Steps: 54 | Train Loss: 2465.8865831 Vali Loss: 2081.6950684 
Validation loss decreased (2779.748866 --> 2081.695068).  Saving model ...
Epoch: 6 cost time: 16.156538486480713
Epoch: 6, Steps: 54 | Train Loss: 1813.7857666 Vali Loss: 1476.5716378 
Validation loss decreased (2081.695068 --> 1476.571638).  Saving model ...
Epoch: 7 cost time: 17.174442529678345
Epoch: 7, Steps: 54 | Train Loss: 1271.1305090 Vali Loss: 999.1349836 
Validation loss decreased (1476.571638 --> 999.134984).  Saving model ...
Epoch: 8 cost time: 16.529492378234863
Epoch: 8, Steps: 54 | Train Loss: 867.7782468 Vali Loss: 656.8160575 
Validation loss decreased (999.134984 --> 656.816057).  Saving model ...
Epoch: 9 cost time: 16.431695461273193
Epoch: 9, Steps: 54 | Train Loss: 567.7887008 Vali Loss: 420.3914904 
Validation loss decreased (656.816057 --> 420.391490).  Saving model ...
Epoch: 10 cost time: 16.63309955596924
Epoch: 10, Steps: 54 | Train Loss: 372.8205137 Vali Loss: 270.2532240 
Validation loss decreased (420.391490 --> 270.253224).  Saving model ...
Epoch: 11 cost time: 16.701500415802002
Epoch: 11, Steps: 54 | Train Loss: 247.2496807 Vali Loss: 174.8416007 
Validation loss decreased (270.253224 --> 174.841601).  Saving model ...
Epoch: 12 cost time: 16.45240092277527
Epoch: 12, Steps: 54 | Train Loss: 169.0595336 Vali Loss: 114.6949621 
Validation loss decreased (174.841601 --> 114.694962).  Saving model ...
Epoch: 13 cost time: 18.50220036506653
Epoch: 13, Steps: 54 | Train Loss: 119.4816547 Vali Loss: 77.0938154 
Validation loss decreased (114.694962 --> 77.093815).  Saving model ...
Epoch: 14 cost time: 16.70155096054077
Epoch: 14, Steps: 54 | Train Loss: 86.9993158 Vali Loss: 58.3237242 
Validation loss decreased (77.093815 --> 58.323724).  Saving model ...
Epoch: 15 cost time: 16.778489351272583
Epoch: 15, Steps: 54 | Train Loss: 66.6175478 Vali Loss: 39.6934357 
Validation loss decreased (58.323724 --> 39.693436).  Saving model ...
Epoch: 16 cost time: 17.806036710739136
Epoch: 16, Steps: 54 | Train Loss: 52.6835232 Vali Loss: 29.5096348 
Validation loss decreased (39.693436 --> 29.509635).  Saving model ...
Epoch: 17 cost time: 17.7516348361969
Epoch: 17, Steps: 54 | Train Loss: 43.2694273 Vali Loss: 24.8348765 
Validation loss decreased (29.509635 --> 24.834876).  Saving model ...
Epoch: 18 cost time: 17.333950519561768
Epoch: 18, Steps: 54 | Train Loss: 36.3655968 Vali Loss: 19.1079893 
Validation loss decreased (24.834876 --> 19.107989).  Saving model ...
Epoch: 19 cost time: 17.59794020652771
Epoch: 19, Steps: 54 | Train Loss: 31.4826066 Vali Loss: 16.5457447 
Validation loss decreased (19.107989 --> 16.545745).  Saving model ...
Epoch: 20 cost time: 18.226715803146362
Epoch: 20, Steps: 54 | Train Loss: 27.8619785 Vali Loss: 15.9858598 
Validation loss decreased (16.545745 --> 15.985860).  Saving model ...
Epoch: 21 cost time: 17.092039346694946
Epoch: 21, Steps: 54 | Train Loss: 24.8978918 Vali Loss: 12.5863318 
Validation loss decreased (15.985860 --> 12.586332).  Saving model ...
Epoch: 22 cost time: 17.200733184814453
Epoch: 22, Steps: 54 | Train Loss: 22.8684077 Vali Loss: 10.6985664 
Validation loss decreased (12.586332 --> 10.698566).  Saving model ...
Epoch: 23 cost time: 17.680370569229126
Epoch: 23, Steps: 54 | Train Loss: 21.3718182 Vali Loss: 9.9139727 
Validation loss decreased (10.698566 --> 9.913973).  Saving model ...
Epoch: 24 cost time: 16.94305157661438
Epoch: 24, Steps: 54 | Train Loss: 20.1305917 Vali Loss: 9.6396756 
Validation loss decreased (9.913973 --> 9.639676).  Saving model ...
Epoch: 25 cost time: 17.614805936813354
Epoch: 25, Steps: 54 | Train Loss: 19.1839505 Vali Loss: 8.8158897 
Validation loss decreased (9.639676 --> 8.815890).  Saving model ...
Epoch: 26 cost time: 17.14802384376526
Epoch: 26, Steps: 54 | Train Loss: 18.0941283 Vali Loss: 8.4765351 
Validation loss decreased (8.815890 --> 8.476535).  Saving model ...
Epoch: 27 cost time: 17.29801893234253
Epoch: 27, Steps: 54 | Train Loss: 17.3122750 Vali Loss: 8.0120466 
Validation loss decreased (8.476535 --> 8.012047).  Saving model ...
Epoch: 28 cost time: 17.625950574874878
Epoch: 28, Steps: 54 | Train Loss: 16.6294025 Vali Loss: 7.3629596 
Validation loss decreased (8.012047 --> 7.362960).  Saving model ...
Epoch: 29 cost time: 17.74922752380371
Epoch: 29, Steps: 54 | Train Loss: 16.0134935 Vali Loss: 8.2725661 
EarlyStopping counter: 1 out of 7
Epoch: 30 cost time: 25.381519317626953
Epoch: 30, Steps: 54 | Train Loss: 15.2440901 Vali Loss: 7.5295096 
EarlyStopping counter: 2 out of 7
Epoch: 31 cost time: 24.487109184265137
Epoch: 31, Steps: 54 | Train Loss: 14.7154202 Vali Loss: 7.4058531 
EarlyStopping counter: 3 out of 7
Epoch: 32 cost time: 18.784871101379395
Epoch: 32, Steps: 54 | Train Loss: 14.1585162 Vali Loss: 7.8373782 
EarlyStopping counter: 4 out of 7
Epoch: 33 cost time: 18.42493224143982
Epoch: 33, Steps: 54 | Train Loss: 13.8917632 Vali Loss: 6.4404214 
Validation loss decreased (7.362960 --> 6.440421).  Saving model ...
Epoch: 34 cost time: 18.34714651107788
Epoch: 34, Steps: 54 | Train Loss: 13.4186662 Vali Loss: 6.7256007 
EarlyStopping counter: 1 out of 7
Epoch: 35 cost time: 19.0270779132843
Epoch: 35, Steps: 54 | Train Loss: 13.0379075 Vali Loss: 7.5753933 
EarlyStopping counter: 2 out of 7
Epoch: 36 cost time: 21.147448539733887
Epoch: 36, Steps: 54 | Train Loss: 12.6820024 Vali Loss: 6.6829416 
EarlyStopping counter: 3 out of 7
Epoch: 37 cost time: 20.95116424560547
Epoch: 37, Steps: 54 | Train Loss: 12.2461673 Vali Loss: 6.7329524 
EarlyStopping counter: 4 out of 7
Epoch: 38 cost time: 20.872987985610962
Epoch: 38, Steps: 54 | Train Loss: 11.8329710 Vali Loss: 6.2416204 
Validation loss decreased (6.440421 --> 6.241620).  Saving model ...
Epoch: 39 cost time: 23.283339977264404
Epoch: 39, Steps: 54 | Train Loss: 11.6243091 Vali Loss: 7.3769126 
EarlyStopping counter: 1 out of 7
Epoch: 40 cost time: 23.171326398849487
Epoch: 40, Steps: 54 | Train Loss: 11.5124103 Vali Loss: 5.7169407 
Validation loss decreased (6.241620 --> 5.716941).  Saving model ...
Epoch: 41 cost time: 20.045563220977783
Epoch: 41, Steps: 54 | Train Loss: 10.8722240 Vali Loss: 6.4383406 
EarlyStopping counter: 1 out of 7
Epoch: 42 cost time: 18.479185342788696
Epoch: 42, Steps: 54 | Train Loss: 10.6625054 Vali Loss: 5.9001744 
EarlyStopping counter: 2 out of 7
Epoch: 43 cost time: 20.84822368621826
Epoch: 43, Steps: 54 | Train Loss: 10.4544142 Vali Loss: 5.8225262 
EarlyStopping counter: 3 out of 7
Epoch: 44 cost time: 21.83430242538452
Epoch: 44, Steps: 54 | Train Loss: 10.3024303 Vali Loss: 5.4783844 
Validation loss decreased (5.716941 --> 5.478384).  Saving model ...
Epoch: 45 cost time: 21.94931435585022
Epoch: 45, Steps: 54 | Train Loss: 10.2033131 Vali Loss: 5.6803555 
EarlyStopping counter: 1 out of 7
Epoch: 46 cost time: 20.648377656936646
Epoch: 46, Steps: 54 | Train Loss: 9.9970387 Vali Loss: 5.4198381 
Validation loss decreased (5.478384 --> 5.419838).  Saving model ...
Epoch: 47 cost time: 17.75191879272461
Epoch: 47, Steps: 54 | Train Loss: 9.7633587 Vali Loss: 5.7532634 
EarlyStopping counter: 1 out of 7
Epoch: 48 cost time: 17.615493297576904
Epoch: 48, Steps: 54 | Train Loss: 9.6844967 Vali Loss: 5.7987373 
EarlyStopping counter: 2 out of 7
Epoch: 49 cost time: 18.522448301315308
Epoch: 49, Steps: 54 | Train Loss: 9.5209048 Vali Loss: 5.7107693 
EarlyStopping counter: 3 out of 7
Epoch: 50 cost time: 17.147281885147095
Epoch: 50, Steps: 54 | Train Loss: 9.4113341 Vali Loss: 5.5983395 
EarlyStopping counter: 4 out of 7
Epoch: 51 cost time: 17.543001890182495
Epoch: 51, Steps: 54 | Train Loss: 9.2858795 Vali Loss: 5.1796665 
Validation loss decreased (5.419838 --> 5.179666).  Saving model ...
Epoch: 52 cost time: 17.583711862564087
Epoch: 52, Steps: 54 | Train Loss: 9.0574922 Vali Loss: 6.1851580 
EarlyStopping counter: 1 out of 7
Epoch: 53 cost time: 17.14044499397278
Epoch: 53, Steps: 54 | Train Loss: 8.9803674 Vali Loss: 6.4164191 
EarlyStopping counter: 2 out of 7
Epoch: 54 cost time: 17.02918529510498
Epoch: 54, Steps: 54 | Train Loss: 8.7924197 Vali Loss: 5.4592919 
EarlyStopping counter: 3 out of 7
Epoch: 55 cost time: 15.328031063079834
Epoch: 55, Steps: 54 | Train Loss: 8.6909213 Vali Loss: 5.9135789 
EarlyStopping counter: 4 out of 7
Epoch: 56 cost time: 15.737237215042114
Epoch: 56, Steps: 54 | Train Loss: 8.5642493 Vali Loss: 5.5136573 
EarlyStopping counter: 5 out of 7
Epoch: 57 cost time: 16.012787342071533
Epoch: 57, Steps: 54 | Train Loss: 8.5328975 Vali Loss: 5.3661966 
EarlyStopping counter: 6 out of 7
Epoch: 58 cost time: 16.477176904678345
Epoch: 58, Steps: 54 | Train Loss: 8.2942883 Vali Loss: 5.6114302 
EarlyStopping counter: 7 out of 7
Early stopping
Training finished!
prediction:  (366275, 84)
groundtruth:  (366275, 84)
MSE: 4.984640121459961, MAE: 1.515531301498413
Testing finished!
Spend Time:  1303.9158689975739
