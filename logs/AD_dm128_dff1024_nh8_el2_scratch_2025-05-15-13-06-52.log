------------ Options -------------
batch_size: 16384
d_channel: 8
d_ff: 1024
d_model: 128
data_path: ./processed_dataset
dataset: AD
dropout: 0.1
e_layers: 2
input_c: 84
k: 0
lr: 0.001
mode: scratch
model_name: ours
model_save_path: checkpoints
n_heads: 8
num_epochs: 100
output_c: 84
seed: 2023
win_size: 1
-------------- End ----------------
train_loader len: 54
val_loader len: 14
test_loader len: 23
======================TRAIN MODE======================
Epoch: 1 cost time: 18.794397354125977
Epoch: 1, Steps: 54 | Train Loss: 5210.3501519 Vali Loss: 5005.9692383 
Validation loss decreased (inf --> 5005.969238).  Saving model ...
Epoch: 2 cost time: 15.478375911712646
Epoch: 2, Steps: 54 | Train Loss: 4761.8705603 Vali Loss: 4451.6057826 
Validation loss decreased (5005.969238 --> 4451.605783).  Saving model ...
Epoch: 3 cost time: 15.92503833770752
Epoch: 3, Steps: 54 | Train Loss: 4146.0571651 Vali Loss: 3782.0601807 
Validation loss decreased (4451.605783 --> 3782.060181).  Saving model ...
Epoch: 4 cost time: 15.861236095428467
Epoch: 4, Steps: 54 | Train Loss: 3462.2656566 Vali Loss: 3059.4045410 
Validation loss decreased (3782.060181 --> 3059.404541).  Saving model ...
Epoch: 5 cost time: 15.634886741638184
Epoch: 5, Steps: 54 | Train Loss: 2717.2919786 Vali Loss: 2287.9578334 
Validation loss decreased (3059.404541 --> 2287.957833).  Saving model ...
Epoch: 6 cost time: 15.84152102470398
Epoch: 6, Steps: 54 | Train Loss: 1984.4932613 Vali Loss: 1617.3235735 
Validation loss decreased (2287.957833 --> 1617.323574).  Saving model ...
Epoch: 7 cost time: 15.26755666732788
Epoch: 7, Steps: 54 | Train Loss: 1382.7847200 Vali Loss: 1084.5700771 
Validation loss decreased (1617.323574 --> 1084.570077).  Saving model ...
Epoch: 8 cost time: 15.52729058265686
Epoch: 8, Steps: 54 | Train Loss: 932.9989387 Vali Loss: 708.4327741 
Validation loss decreased (1084.570077 --> 708.432774).  Saving model ...
Epoch: 9 cost time: 15.964938163757324
Epoch: 9, Steps: 54 | Train Loss: 613.8280623 Vali Loss: 450.4212755 
Validation loss decreased (708.432774 --> 450.421276).  Saving model ...
Epoch: 10 cost time: 15.406425952911377
Epoch: 10, Steps: 54 | Train Loss: 400.6519832 Vali Loss: 286.7519727 
Validation loss decreased (450.421276 --> 286.751973).  Saving model ...
Epoch: 11 cost time: 15.96367335319519
Epoch: 11, Steps: 54 | Train Loss: 264.5127467 Vali Loss: 189.5779092 
Validation loss decreased (286.751973 --> 189.577909).  Saving model ...
Epoch: 12 cost time: 15.589840173721313
Epoch: 12, Steps: 54 | Train Loss: 179.9379888 Vali Loss: 126.9157382 
Validation loss decreased (189.577909 --> 126.915738).  Saving model ...
Epoch: 13 cost time: 14.894514560699463
Epoch: 13, Steps: 54 | Train Loss: 125.8328034 Vali Loss: 84.7472311 
Validation loss decreased (126.915738 --> 84.747231).  Saving model ...
Epoch: 14 cost time: 15.734461307525635
Epoch: 14, Steps: 54 | Train Loss: 92.1117689 Vali Loss: 57.8151376 
Validation loss decreased (84.747231 --> 57.815138).  Saving model ...
Epoch: 15 cost time: 15.704714059829712
Epoch: 15, Steps: 54 | Train Loss: 69.5688116 Vali Loss: 42.0951388 
Validation loss decreased (57.815138 --> 42.095139).  Saving model ...
Epoch: 16 cost time: 15.395761251449585
Epoch: 16, Steps: 54 | Train Loss: 54.8770575 Vali Loss: 32.1386687 
Validation loss decreased (42.095139 --> 32.138669).  Saving model ...
Epoch: 17 cost time: 15.952347040176392
Epoch: 17, Steps: 54 | Train Loss: 44.9925948 Vali Loss: 26.8499643 
Validation loss decreased (32.138669 --> 26.849964).  Saving model ...
Epoch: 18 cost time: 14.972856521606445
Epoch: 18, Steps: 54 | Train Loss: 37.8754592 Vali Loss: 21.5496708 
Validation loss decreased (26.849964 --> 21.549671).  Saving model ...
Epoch: 19 cost time: 15.69420075416565
Epoch: 19, Steps: 54 | Train Loss: 32.9246006 Vali Loss: 17.7428962 
Validation loss decreased (21.549671 --> 17.742896).  Saving model ...
Epoch: 20 cost time: 15.949262380599976
Epoch: 20, Steps: 54 | Train Loss: 29.2072047 Vali Loss: 15.0167752 
Validation loss decreased (17.742896 --> 15.016775).  Saving model ...
Epoch: 21 cost time: 15.770061731338501
Epoch: 21, Steps: 54 | Train Loss: 26.1722886 Vali Loss: 14.2755241 
Validation loss decreased (15.016775 --> 14.275524).  Saving model ...
Epoch: 22 cost time: 14.985129356384277
Epoch: 22, Steps: 54 | Train Loss: 24.2764468 Vali Loss: 14.5286761 
EarlyStopping counter: 1 out of 7
Epoch: 23 cost time: 15.436279296875
Epoch: 23, Steps: 54 | Train Loss: 22.8279734 Vali Loss: 11.8675137 
Validation loss decreased (14.275524 --> 11.867514).  Saving model ...
Epoch: 24 cost time: 15.813039302825928
Epoch: 24, Steps: 54 | Train Loss: 21.4085114 Vali Loss: 13.3286095 
EarlyStopping counter: 1 out of 7
Epoch: 25 cost time: 16.4138662815094
Epoch: 25, Steps: 54 | Train Loss: 20.2441272 Vali Loss: 11.4365535 
Validation loss decreased (11.867514 --> 11.436553).  Saving model ...
Epoch: 26 cost time: 15.956994771957397
Epoch: 26, Steps: 54 | Train Loss: 19.2312838 Vali Loss: 10.4990492 
Validation loss decreased (11.436553 --> 10.499049).  Saving model ...
Epoch: 27 cost time: 16.487358331680298
Epoch: 27, Steps: 54 | Train Loss: 18.3674597 Vali Loss: 10.6730043 
EarlyStopping counter: 1 out of 7
Epoch: 28 cost time: 16.60473656654358
Epoch: 28, Steps: 54 | Train Loss: 17.6653146 Vali Loss: 10.1136364 
Validation loss decreased (10.499049 --> 10.113636).  Saving model ...
Epoch: 29 cost time: 16.372381687164307
Epoch: 29, Steps: 54 | Train Loss: 16.9927346 Vali Loss: 9.8413429 
Validation loss decreased (10.113636 --> 9.841343).  Saving model ...
Epoch: 30 cost time: 15.731558322906494
Epoch: 30, Steps: 54 | Train Loss: 16.3360277 Vali Loss: 9.1977653 
Validation loss decreased (9.841343 --> 9.197765).  Saving model ...
Epoch: 31 cost time: 17.308294773101807
Epoch: 31, Steps: 54 | Train Loss: 15.8330390 Vali Loss: 11.0636021 
EarlyStopping counter: 1 out of 7
Epoch: 32 cost time: 16.546157360076904
Epoch: 32, Steps: 54 | Train Loss: 15.2971333 Vali Loss: 9.9351228 
EarlyStopping counter: 2 out of 7
Epoch: 33 cost time: 16.297170400619507
Epoch: 33, Steps: 54 | Train Loss: 14.7905202 Vali Loss: 8.8280726 
Validation loss decreased (9.197765 --> 8.828073).  Saving model ...
Epoch: 34 cost time: 15.791345119476318
Epoch: 34, Steps: 54 | Train Loss: 14.3588716 Vali Loss: 9.3692101 
EarlyStopping counter: 1 out of 7
Epoch: 35 cost time: 16.172879695892334
Epoch: 35, Steps: 54 | Train Loss: 14.0475278 Vali Loss: 9.8937949 
EarlyStopping counter: 2 out of 7
Epoch: 36 cost time: 16.374474048614502
Epoch: 36, Steps: 54 | Train Loss: 13.7020097 Vali Loss: 9.5627995 
EarlyStopping counter: 3 out of 7
Epoch: 37 cost time: 15.820313453674316
Epoch: 37, Steps: 54 | Train Loss: 13.1989116 Vali Loss: 9.1587206 
EarlyStopping counter: 4 out of 7
Epoch: 38 cost time: 16.583959341049194
Epoch: 38, Steps: 54 | Train Loss: 12.9828517 Vali Loss: 9.7565327 
EarlyStopping counter: 5 out of 7
Epoch: 39 cost time: 15.510173797607422
Epoch: 39, Steps: 54 | Train Loss: 12.6291194 Vali Loss: 11.6247653 
EarlyStopping counter: 6 out of 7
Epoch: 40 cost time: 16.28617763519287
Epoch: 40, Steps: 54 | Train Loss: 12.2842263 Vali Loss: 8.5431074 
Validation loss decreased (8.828073 --> 8.543107).  Saving model ...
Epoch: 41 cost time: 16.380889177322388
Epoch: 41, Steps: 54 | Train Loss: 11.9567850 Vali Loss: 8.1953223 
Validation loss decreased (8.543107 --> 8.195322).  Saving model ...
Epoch: 42 cost time: 15.671476364135742
Epoch: 42, Steps: 54 | Train Loss: 11.7397496 Vali Loss: 9.7172504 
EarlyStopping counter: 1 out of 7
Epoch: 43 cost time: 16.377251863479614
Epoch: 43, Steps: 54 | Train Loss: 11.5241341 Vali Loss: 8.4811918 
EarlyStopping counter: 2 out of 7
Epoch: 44 cost time: 16.383699655532837
Epoch: 44, Steps: 54 | Train Loss: 11.3320586 Vali Loss: 8.7854744 
EarlyStopping counter: 3 out of 7
Epoch: 45 cost time: 15.996938705444336
Epoch: 45, Steps: 54 | Train Loss: 11.1576579 Vali Loss: 9.0974641 
EarlyStopping counter: 4 out of 7
Epoch: 46 cost time: 16.253544807434082
Epoch: 46, Steps: 54 | Train Loss: 11.0442249 Vali Loss: 8.8310072 
EarlyStopping counter: 5 out of 7
Epoch: 47 cost time: 15.92354416847229
Epoch: 47, Steps: 54 | Train Loss: 10.8464092 Vali Loss: 8.3326097 
EarlyStopping counter: 6 out of 7
Epoch: 48 cost time: 16.222241163253784
Epoch: 48, Steps: 54 | Train Loss: 10.6637317 Vali Loss: 8.8775268 
EarlyStopping counter: 7 out of 7
Early stopping
Training finished!
prediction:  (366275, 84)
groundtruth:  (366275, 84)
MSE: 8.452282905578613, MAE: 1.964216947555542
Testing finished!
Spend Time:  958.1159348487854
