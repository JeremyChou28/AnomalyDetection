------------ Options -------------
batch_size: 16384
d_channel: 4
d_ff: 1024
d_model: 512
data_path: ./processed_dataset
dataset: AD
dropout: 0.1
e_layers: 3
input_c: 84
k: 0
lr: 0.001
mode: scratch
model_name: ours
model_save_path: checkpoints
n_heads: 4
num_epochs: 100
output_c: 84
seed: 2023
win_size: 1
-------------- End ----------------
train_loader len: 54
val_loader len: 14
test_loader len: 23
======================TRAIN MODE======================
Epoch: 1 cost time: 20.43383002281189
Epoch: 1, Steps: 54 | Train Loss: 5046.1711697 Vali Loss: 4651.8463309 
Validation loss decreased (inf --> 4651.846331).  Saving model ...
Epoch: 2 cost time: 17.064510583877563
Epoch: 2, Steps: 54 | Train Loss: 4230.1625479 Vali Loss: 3720.2829590 
Validation loss decreased (4651.846331 --> 3720.282959).  Saving model ...
Epoch: 3 cost time: 16.673158168792725
Epoch: 3, Steps: 54 | Train Loss: 3275.7391764 Vali Loss: 2754.9854736 
Validation loss decreased (3720.282959 --> 2754.985474).  Saving model ...
Epoch: 4 cost time: 16.832234382629395
Epoch: 4, Steps: 54 | Train Loss: 2362.4729072 Vali Loss: 1902.9703195 
Validation loss decreased (2754.985474 --> 1902.970319).  Saving model ...
Epoch: 5 cost time: 16.556559085845947
Epoch: 5, Steps: 54 | Train Loss: 1565.7276657 Vali Loss: 1174.0238909 
Validation loss decreased (1902.970319 --> 1174.023891).  Saving model ...
Epoch: 6 cost time: 15.848514556884766
Epoch: 6, Steps: 54 | Train Loss: 970.3089701 Vali Loss: 685.5671997 
Validation loss decreased (1174.023891 --> 685.567200).  Saving model ...
Epoch: 7 cost time: 16.484086275100708
Epoch: 7, Steps: 54 | Train Loss: 551.0165790 Vali Loss: 371.4076625 
Validation loss decreased (685.567200 --> 371.407663).  Saving model ...
Epoch: 8 cost time: 16.182038068771362
Epoch: 8, Steps: 54 | Train Loss: 305.4107971 Vali Loss: 195.8136967 
Validation loss decreased (371.407663 --> 195.813697).  Saving model ...
Epoch: 9 cost time: 17.01352334022522
Epoch: 9, Steps: 54 | Train Loss: 171.9203847 Vali Loss: 104.5928454 
Validation loss decreased (195.813697 --> 104.592845).  Saving model ...
Epoch: 10 cost time: 16.151219367980957
Epoch: 10, Steps: 54 | Train Loss: 101.8668974 Vali Loss: 60.5595303 
Validation loss decreased (104.592845 --> 60.559530).  Saving model ...
Epoch: 11 cost time: 16.678826093673706
Epoch: 11, Steps: 54 | Train Loss: 64.8318239 Vali Loss: 34.3306852 
Validation loss decreased (60.559530 --> 34.330685).  Saving model ...
Epoch: 12 cost time: 16.70449161529541
Epoch: 12, Steps: 54 | Train Loss: 44.9829445 Vali Loss: 22.3107583 
Validation loss decreased (34.330685 --> 22.310758).  Saving model ...
Epoch: 13 cost time: 20.28997778892517
Epoch: 13, Steps: 54 | Train Loss: 33.3628054 Vali Loss: 15.4071341 
Validation loss decreased (22.310758 --> 15.407134).  Saving model ...
Epoch: 14 cost time: 16.777727365493774
Epoch: 14, Steps: 54 | Train Loss: 1359.4226886 Vali Loss: 2292.5423758 
EarlyStopping counter: 1 out of 7
Epoch: 15 cost time: 16.170828342437744
Epoch: 15, Steps: 54 | Train Loss: 1726.6242495 Vali Loss: 1114.4922660 
EarlyStopping counter: 2 out of 7
Epoch: 16 cost time: 16.99504518508911
Epoch: 16, Steps: 54 | Train Loss: 962.5114588 Vali Loss: 388.6670554 
EarlyStopping counter: 3 out of 7
Epoch: 17 cost time: 16.51394295692444
Epoch: 17, Steps: 54 | Train Loss: 508.0591148 Vali Loss: 169.4271447 
EarlyStopping counter: 4 out of 7
Epoch: 18 cost time: 16.734976291656494
Epoch: 18, Steps: 54 | Train Loss: 337.6850207 Vali Loss: 96.5720596 
EarlyStopping counter: 5 out of 7
Epoch: 19 cost time: 16.25494909286499
Epoch: 19, Steps: 54 | Train Loss: 253.4453540 Vali Loss: 69.1175466 
EarlyStopping counter: 6 out of 7
Epoch: 20 cost time: 16.589342832565308
Epoch: 20, Steps: 54 | Train Loss: 215.8512192 Vali Loss: 47.4820028 
EarlyStopping counter: 7 out of 7
Early stopping
Training finished!
prediction:  (366275, 84)
groundtruth:  (366275, 84)
MSE: 16.633502960205078, MAE: 2.0072364807128906
Testing finished!
Spend Time:  434.7342655658722
