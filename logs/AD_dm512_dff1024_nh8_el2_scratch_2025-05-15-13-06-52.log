------------ Options -------------
batch_size: 16384
d_channel: 8
d_ff: 1024
d_model: 512
data_path: ./processed_dataset
dataset: AD
dropout: 0.1
e_layers: 2
input_c: 84
k: 0
lr: 0.001
mode: scratch
model_name: ours
model_save_path: checkpoints
n_heads: 8
num_epochs: 100
output_c: 84
seed: 2023
win_size: 1
-------------- End ----------------
train_loader len: 54
val_loader len: 14
test_loader len: 23
======================TRAIN MODE======================
Epoch: 1 cost time: 23.150916814804077
Epoch: 1, Steps: 54 | Train Loss: 4805.3340205 Vali Loss: 4173.7506278 
Validation loss decreased (inf --> 4173.750628).  Saving model ...
Epoch: 2 cost time: 19.114494562149048
Epoch: 2, Steps: 54 | Train Loss: 3602.1335811 Vali Loss: 2903.9245431 
Validation loss decreased (4173.750628 --> 2903.924543).  Saving model ...
Epoch: 3 cost time: 18.992064714431763
Epoch: 3, Steps: 54 | Train Loss: 2408.5390512 Vali Loss: 1784.6844744 
Validation loss decreased (2903.924543 --> 1784.684474).  Saving model ...
Epoch: 4 cost time: 19.146361351013184
Epoch: 4, Steps: 54 | Train Loss: 1457.3046197 Vali Loss: 987.5099313 
Validation loss decreased (1784.684474 --> 987.509931).  Saving model ...
Epoch: 5 cost time: 19.320379734039307
Epoch: 5, Steps: 54 | Train Loss: 769.7486233 Vali Loss: 473.2734070 
Validation loss decreased (987.509931 --> 473.273407).  Saving model ...
Epoch: 6 cost time: 19.245982885360718
Epoch: 6, Steps: 54 | Train Loss: 426.2646213 Vali Loss: 303.9674050 
Validation loss decreased (473.273407 --> 303.967405).  Saving model ...
Epoch: 7 cost time: 18.709864139556885
Epoch: 7, Steps: 54 | Train Loss: 229.5985531 Vali Loss: 108.8121229 
Validation loss decreased (303.967405 --> 108.812123).  Saving model ...
Epoch: 8 cost time: 19.139753341674805
Epoch: 8, Steps: 54 | Train Loss: 110.9106036 Vali Loss: 54.6785556 
Validation loss decreased (108.812123 --> 54.678556).  Saving model ...
Epoch: 9 cost time: 19.358673572540283
Epoch: 9, Steps: 54 | Train Loss: 66.1019282 Vali Loss: 32.8223237 
Validation loss decreased (54.678556 --> 32.822324).  Saving model ...
Epoch: 10 cost time: 19.0810227394104
Epoch: 10, Steps: 54 | Train Loss: 45.3428825 Vali Loss: 22.9867332 
Validation loss decreased (32.822324 --> 22.986733).  Saving model ...
Epoch: 11 cost time: 19.68471932411194
Epoch: 11, Steps: 54 | Train Loss: 34.5229806 Vali Loss: 19.2188974 
Validation loss decreased (22.986733 --> 19.218897).  Saving model ...
Epoch: 12 cost time: 19.75613236427307
Epoch: 12, Steps: 54 | Train Loss: 28.3797619 Vali Loss: 14.5916888 
Validation loss decreased (19.218897 --> 14.591689).  Saving model ...
Epoch: 13 cost time: 19.569209337234497
Epoch: 13, Steps: 54 | Train Loss: 23.8692550 Vali Loss: 12.8215139 
Validation loss decreased (14.591689 --> 12.821514).  Saving model ...
Epoch: 14 cost time: 18.84606146812439
Epoch: 14, Steps: 54 | Train Loss: 21.2794653 Vali Loss: 13.7288912 
EarlyStopping counter: 1 out of 7
Epoch: 15 cost time: 18.527667999267578
Epoch: 15, Steps: 54 | Train Loss: 19.0185880 Vali Loss: 13.2522544 
EarlyStopping counter: 2 out of 7
Epoch: 16 cost time: 19.212966203689575
Epoch: 16, Steps: 54 | Train Loss: 17.3654304 Vali Loss: 12.0148017 
Validation loss decreased (12.821514 --> 12.014802).  Saving model ...
Epoch: 17 cost time: 18.730120182037354
Epoch: 17, Steps: 54 | Train Loss: 15.9744585 Vali Loss: 10.8458020 
Validation loss decreased (12.014802 --> 10.845802).  Saving model ...
Epoch: 18 cost time: 19.024905920028687
Epoch: 18, Steps: 54 | Train Loss: 15.0089319 Vali Loss: 11.5990067 
EarlyStopping counter: 1 out of 7
Epoch: 19 cost time: 19.060320138931274
Epoch: 19, Steps: 54 | Train Loss: 13.9501755 Vali Loss: 10.4806211 
Validation loss decreased (10.845802 --> 10.480621).  Saving model ...
Epoch: 20 cost time: 18.225117921829224
Epoch: 20, Steps: 54 | Train Loss: 13.7602765 Vali Loss: 11.0630492 
EarlyStopping counter: 1 out of 7
Epoch: 21 cost time: 19.037822723388672
Epoch: 21, Steps: 54 | Train Loss: 12.5015330 Vali Loss: 11.5429700 
EarlyStopping counter: 2 out of 7
Epoch: 22 cost time: 19.033113956451416
Epoch: 22, Steps: 54 | Train Loss: 11.9497826 Vali Loss: 11.9699969 
EarlyStopping counter: 3 out of 7
Epoch: 23 cost time: 18.77526330947876
Epoch: 23, Steps: 54 | Train Loss: 11.4132651 Vali Loss: 12.4804296 
EarlyStopping counter: 4 out of 7
Epoch: 24 cost time: 18.199440956115723
Epoch: 24, Steps: 54 | Train Loss: 11.2599611 Vali Loss: 11.5605758 
EarlyStopping counter: 5 out of 7
Epoch: 25 cost time: 19.02973508834839
Epoch: 25, Steps: 54 | Train Loss: 10.7519702 Vali Loss: 12.0073216 
EarlyStopping counter: 6 out of 7
Epoch: 26 cost time: 18.837108850479126
Epoch: 26, Steps: 54 | Train Loss: 10.3198143 Vali Loss: 11.6204596 
EarlyStopping counter: 7 out of 7
Early stopping
Training finished!
prediction:  (366275, 84)
groundtruth:  (366275, 84)
MSE: 11.100041389465332, MAE: 2.1773741245269775
Testing finished!
Spend Time:  630.5559589862823
