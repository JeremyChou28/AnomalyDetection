------------ Options -------------
batch_size: 16384
d_channel: 8
d_ff: 1024
d_model: 512
data_path: ./processed_dataset
dataset: AD
dropout: 0.1
e_layers: 2
input_c: 84
k: 0
lr: 0.001
mode: scratch
model_name: ours
model_save_path: checkpoints
n_heads: 4
num_epochs: 100
output_c: 84
seed: 2023
win_size: 1
-------------- End ----------------
train_loader len: 54
val_loader len: 14
test_loader len: 23
======================TRAIN MODE======================
Epoch: 1 cost time: 21.902189254760742
Epoch: 1, Steps: 54 | Train Loss: 4811.3312807 Vali Loss: 4179.5593610 
Validation loss decreased (inf --> 4179.559361).  Saving model ...
Epoch: 2 cost time: 18.758667707443237
Epoch: 2, Steps: 54 | Train Loss: 3598.1756501 Vali Loss: 2877.1039516 
Validation loss decreased (4179.559361 --> 2877.103952).  Saving model ...
Epoch: 3 cost time: 18.293105125427246
Epoch: 3, Steps: 54 | Train Loss: 2362.0129146 Vali Loss: 1730.0871931 
Validation loss decreased (2877.103952 --> 1730.087193).  Saving model ...
Epoch: 4 cost time: 18.081197500228882
Epoch: 4, Steps: 54 | Train Loss: 1406.3527222 Vali Loss: 939.3678284 
Validation loss decreased (1730.087193 --> 939.367828).  Saving model ...
Epoch: 5 cost time: 18.263154983520508
Epoch: 5, Steps: 54 | Train Loss: 757.3298871 Vali Loss: 463.1104170 
Validation loss decreased (939.367828 --> 463.110417).  Saving model ...
Epoch: 6 cost time: 18.19201636314392
Epoch: 6, Steps: 54 | Train Loss: 383.8599695 Vali Loss: 217.5121634 
Validation loss decreased (463.110417 --> 217.512163).  Saving model ...
Epoch: 7 cost time: 18.165204286575317
Epoch: 7, Steps: 54 | Train Loss: 194.9989729 Vali Loss: 106.9707456 
Validation loss decreased (217.512163 --> 106.970746).  Saving model ...
Epoch: 8 cost time: 17.630468368530273
Epoch: 8, Steps: 54 | Train Loss: 108.7776841 Vali Loss: 57.9944346 
Validation loss decreased (106.970746 --> 57.994435).  Saving model ...
Epoch: 9 cost time: 18.123575925827026
Epoch: 9, Steps: 54 | Train Loss: 66.9232033 Vali Loss: 35.5574066 
Validation loss decreased (57.994435 --> 35.557407).  Saving model ...
Epoch: 10 cost time: 17.850622415542603
Epoch: 10, Steps: 54 | Train Loss: 48.8639873 Vali Loss: 22.2652980 
Validation loss decreased (35.557407 --> 22.265298).  Saving model ...
Epoch: 11 cost time: 18.047661781311035
Epoch: 11, Steps: 54 | Train Loss: 35.5351070 Vali Loss: 22.9523660 
EarlyStopping counter: 1 out of 7
Epoch: 12 cost time: 18.275640964508057
Epoch: 12, Steps: 54 | Train Loss: 28.6921489 Vali Loss: 16.7024009 
Validation loss decreased (22.265298 --> 16.702401).  Saving model ...
Epoch: 13 cost time: 17.712896585464478
Epoch: 13, Steps: 54 | Train Loss: 24.4256600 Vali Loss: 15.6641152 
Validation loss decreased (16.702401 --> 15.664115).  Saving model ...
Epoch: 14 cost time: 18.23520278930664
Epoch: 14, Steps: 54 | Train Loss: 21.9002058 Vali Loss: 14.8858259 
Validation loss decreased (15.664115 --> 14.885826).  Saving model ...
Epoch: 15 cost time: 17.983781337738037
Epoch: 15, Steps: 54 | Train Loss: 19.5451824 Vali Loss: 17.5921000 
EarlyStopping counter: 1 out of 7
Epoch: 16 cost time: 17.837862968444824
Epoch: 16, Steps: 54 | Train Loss: 18.3684903 Vali Loss: 12.1529574 
Validation loss decreased (14.885826 --> 12.152957).  Saving model ...
Epoch: 17 cost time: 18.171760082244873
Epoch: 17, Steps: 54 | Train Loss: 17.5855365 Vali Loss: 19.5423077 
EarlyStopping counter: 1 out of 7
Epoch: 18 cost time: 17.990163326263428
Epoch: 18, Steps: 54 | Train Loss: 16.3165519 Vali Loss: 14.9879371 
EarlyStopping counter: 2 out of 7
Epoch: 19 cost time: 17.946744680404663
Epoch: 19, Steps: 54 | Train Loss: 14.6356424 Vali Loss: 13.7524055 
EarlyStopping counter: 3 out of 7
Epoch: 20 cost time: 17.70290493965149
Epoch: 20, Steps: 54 | Train Loss: 13.9957709 Vali Loss: 14.6681371 
EarlyStopping counter: 4 out of 7
Epoch: 21 cost time: 18.210946559906006
Epoch: 21, Steps: 54 | Train Loss: 12.8333223 Vali Loss: 13.9948277 
EarlyStopping counter: 5 out of 7
Epoch: 22 cost time: 17.837250232696533
Epoch: 22, Steps: 54 | Train Loss: 12.3044372 Vali Loss: 15.1207126 
EarlyStopping counter: 6 out of 7
Epoch: 23 cost time: 18.19055986404419
Epoch: 23, Steps: 54 | Train Loss: 11.9814241 Vali Loss: 13.9579492 
EarlyStopping counter: 7 out of 7
Early stopping
Training finished!
prediction:  (366275, 84)
groundtruth:  (366275, 84)
MSE: 13.331214904785156, MAE: 2.385474681854248
Testing finished!
Spend Time:  533.3373041152954
