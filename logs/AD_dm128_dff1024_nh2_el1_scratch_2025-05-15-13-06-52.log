------------ Options -------------
batch_size: 16384
d_channel: 8
d_ff: 1024
d_model: 128
data_path: ./processed_dataset
dataset: AD
dropout: 0.1
e_layers: 1
input_c: 84
k: 0
lr: 0.001
mode: scratch
model_name: ours
model_save_path: checkpoints
n_heads: 2
num_epochs: 100
output_c: 84
seed: 2023
win_size: 1
-------------- End ----------------
train_loader len: 54
val_loader len: 14
test_loader len: 23
======================TRAIN MODE======================
Epoch: 1 cost time: 15.955418586730957
Epoch: 1, Steps: 54 | Train Loss: 5195.7399269 Vali Loss: 4967.5131836 
Validation loss decreased (inf --> 4967.513184).  Saving model ...
Epoch: 2 cost time: 13.205500602722168
Epoch: 2, Steps: 54 | Train Loss: 4715.9358091 Vali Loss: 4374.7950265 
Validation loss decreased (4967.513184 --> 4374.795027).  Saving model ...
Epoch: 3 cost time: 13.857446193695068
Epoch: 3, Steps: 54 | Train Loss: 4063.7037489 Vali Loss: 3652.6192627 
Validation loss decreased (4374.795027 --> 3652.619263).  Saving model ...
Epoch: 4 cost time: 13.280696392059326
Epoch: 4, Steps: 54 | Train Loss: 3338.8173828 Vali Loss: 2897.9417899 
Validation loss decreased (3652.619263 --> 2897.941790).  Saving model ...
Epoch: 5 cost time: 13.872591733932495
Epoch: 5, Steps: 54 | Train Loss: 2581.7789081 Vali Loss: 2128.9168004 
Validation loss decreased (2897.941790 --> 2128.916800).  Saving model ...
Epoch: 6 cost time: 13.29651403427124
Epoch: 6, Steps: 54 | Train Loss: 1864.0042951 Vali Loss: 1475.5599627 
Validation loss decreased (2128.916800 --> 1475.559963).  Saving model ...
Epoch: 7 cost time: 13.272925853729248
Epoch: 7, Steps: 54 | Train Loss: 1284.7695041 Vali Loss: 976.7453003 
Validation loss decreased (1475.559963 --> 976.745300).  Saving model ...
Epoch: 8 cost time: 14.2226722240448
Epoch: 8, Steps: 54 | Train Loss: 857.0090637 Vali Loss: 620.2327968 
Validation loss decreased (976.745300 --> 620.232797).  Saving model ...
Epoch: 9 cost time: 13.21241307258606
Epoch: 9, Steps: 54 | Train Loss: 556.0780357 Vali Loss: 385.7904053 
Validation loss decreased (620.232797 --> 385.790405).  Saving model ...
Epoch: 10 cost time: 13.496639251708984
Epoch: 10, Steps: 54 | Train Loss: 358.4886000 Vali Loss: 238.3946163 
Validation loss decreased (385.790405 --> 238.394616).  Saving model ...
Epoch: 11 cost time: 13.726860523223877
Epoch: 11, Steps: 54 | Train Loss: 235.0809552 Vali Loss: 148.5807866 
Validation loss decreased (238.394616 --> 148.580787).  Saving model ...
Epoch: 12 cost time: 14.258432865142822
Epoch: 12, Steps: 54 | Train Loss: 159.4728395 Vali Loss: 97.3825526 
Validation loss decreased (148.580787 --> 97.382553).  Saving model ...
Epoch: 13 cost time: 18.35996174812317
Epoch: 13, Steps: 54 | Train Loss: 113.0122118 Vali Loss: 65.2892985 
Validation loss decreased (97.382553 --> 65.289298).  Saving model ...
Epoch: 14 cost time: 17.769935131072998
Epoch: 14, Steps: 54 | Train Loss: 83.7970396 Vali Loss: 46.8388263 
Validation loss decreased (65.289298 --> 46.838826).  Saving model ...
Epoch: 15 cost time: 18.25127649307251
Epoch: 15, Steps: 54 | Train Loss: 65.9139208 Vali Loss: 34.6409010 
Validation loss decreased (46.838826 --> 34.640901).  Saving model ...
Epoch: 16 cost time: 17.68994975090027
Epoch: 16, Steps: 54 | Train Loss: 53.3176925 Vali Loss: 27.3081809 
Validation loss decreased (34.640901 --> 27.308181).  Saving model ...
Epoch: 17 cost time: 17.896791458129883
Epoch: 17, Steps: 54 | Train Loss: 45.0852002 Vali Loss: 23.1329154 
Validation loss decreased (27.308181 --> 23.132915).  Saving model ...
Epoch: 18 cost time: 17.96540331840515
Epoch: 18, Steps: 54 | Train Loss: 39.0733267 Vali Loss: 19.3168637 
Validation loss decreased (23.132915 --> 19.316864).  Saving model ...
Epoch: 19 cost time: 17.68212127685547
Epoch: 19, Steps: 54 | Train Loss: 34.8483614 Vali Loss: 18.2287321 
Validation loss decreased (19.316864 --> 18.228732).  Saving model ...
Epoch: 20 cost time: 17.004143238067627
Epoch: 20, Steps: 54 | Train Loss: 31.9035209 Vali Loss: 15.5384381 
Validation loss decreased (18.228732 --> 15.538438).  Saving model ...
Epoch: 21 cost time: 13.025818586349487
Epoch: 21, Steps: 54 | Train Loss: 29.0640149 Vali Loss: 13.5237164 
Validation loss decreased (15.538438 --> 13.523716).  Saving model ...
Epoch: 22 cost time: 13.751165628433228
Epoch: 22, Steps: 54 | Train Loss: 27.3766074 Vali Loss: 13.0834866 
Validation loss decreased (13.523716 --> 13.083487).  Saving model ...
Epoch: 23 cost time: 13.659096479415894
Epoch: 23, Steps: 54 | Train Loss: 25.8924376 Vali Loss: 11.5355936 
Validation loss decreased (13.083487 --> 11.535594).  Saving model ...
Epoch: 24 cost time: 13.27281641960144
Epoch: 24, Steps: 54 | Train Loss: 24.8151268 Vali Loss: 12.4287410 
EarlyStopping counter: 1 out of 7
Epoch: 25 cost time: 13.403566598892212
Epoch: 25, Steps: 54 | Train Loss: 23.7985768 Vali Loss: 14.0505020 
EarlyStopping counter: 2 out of 7
Epoch: 26 cost time: 13.740796327590942
Epoch: 26, Steps: 54 | Train Loss: 22.9424646 Vali Loss: 11.8080087 
EarlyStopping counter: 3 out of 7
Epoch: 27 cost time: 13.166990041732788
Epoch: 27, Steps: 54 | Train Loss: 21.9283846 Vali Loss: 10.7486937 
Validation loss decreased (11.535594 --> 10.748694).  Saving model ...
Epoch: 28 cost time: 13.82746934890747
Epoch: 28, Steps: 54 | Train Loss: 21.4761106 Vali Loss: 11.6697012 
EarlyStopping counter: 1 out of 7
Epoch: 29 cost time: 13.29797077178955
Epoch: 29, Steps: 54 | Train Loss: 20.6745479 Vali Loss: 11.8053173 
EarlyStopping counter: 2 out of 7
Epoch: 30 cost time: 13.453816175460815
Epoch: 30, Steps: 54 | Train Loss: 19.9375171 Vali Loss: 10.9882273 
EarlyStopping counter: 3 out of 7
Epoch: 31 cost time: 13.251904726028442
Epoch: 31, Steps: 54 | Train Loss: 19.4094225 Vali Loss: 8.9620256 
Validation loss decreased (10.748694 --> 8.962026).  Saving model ...
Epoch: 32 cost time: 13.1774320602417
Epoch: 32, Steps: 54 | Train Loss: 19.0952507 Vali Loss: 11.0998049 
EarlyStopping counter: 1 out of 7
Epoch: 33 cost time: 13.720787286758423
Epoch: 33, Steps: 54 | Train Loss: 18.6574531 Vali Loss: 12.0336584 
EarlyStopping counter: 2 out of 7
Epoch: 34 cost time: 13.25797986984253
Epoch: 34, Steps: 54 | Train Loss: 18.2456130 Vali Loss: 10.5408753 
EarlyStopping counter: 3 out of 7
Epoch: 35 cost time: 13.736152648925781
Epoch: 35, Steps: 54 | Train Loss: 17.7877024 Vali Loss: 8.8587177 
Validation loss decreased (8.962026 --> 8.858718).  Saving model ...
Epoch: 36 cost time: 13.0684175491333
Epoch: 36, Steps: 54 | Train Loss: 17.4106835 Vali Loss: 8.7697799 
Validation loss decreased (8.858718 --> 8.769780).  Saving model ...
Epoch: 37 cost time: 13.727373361587524
Epoch: 37, Steps: 54 | Train Loss: 17.0921553 Vali Loss: 11.4090817 
EarlyStopping counter: 1 out of 7
Epoch: 38 cost time: 13.091078996658325
Epoch: 38, Steps: 54 | Train Loss: 16.6361891 Vali Loss: 10.5343323 
EarlyStopping counter: 2 out of 7
Epoch: 39 cost time: 13.408302783966064
Epoch: 39, Steps: 54 | Train Loss: 16.5086410 Vali Loss: 10.6950877 
EarlyStopping counter: 3 out of 7
Epoch: 40 cost time: 13.63611912727356
Epoch: 40, Steps: 54 | Train Loss: 16.1781735 Vali Loss: 9.1559865 
EarlyStopping counter: 4 out of 7
Epoch: 41 cost time: 13.198986053466797
Epoch: 41, Steps: 54 | Train Loss: 15.5584517 Vali Loss: 8.7064920 
Validation loss decreased (8.769780 --> 8.706492).  Saving model ...
Epoch: 42 cost time: 13.679308414459229
Epoch: 42, Steps: 54 | Train Loss: 15.3825660 Vali Loss: 9.6332592 
EarlyStopping counter: 1 out of 7
Epoch: 43 cost time: 13.30465054512024
Epoch: 43, Steps: 54 | Train Loss: 15.1468193 Vali Loss: 8.5153901 
Validation loss decreased (8.706492 --> 8.515390).  Saving model ...
Epoch: 44 cost time: 13.096805095672607
Epoch: 44, Steps: 54 | Train Loss: 15.0150977 Vali Loss: 9.6700995 
EarlyStopping counter: 1 out of 7
Epoch: 45 cost time: 13.707082986831665
Epoch: 45, Steps: 54 | Train Loss: 14.8137280 Vali Loss: 8.2693722 
Validation loss decreased (8.515390 --> 8.269372).  Saving model ...
Epoch: 46 cost time: 13.016764402389526
Epoch: 46, Steps: 54 | Train Loss: 14.6009853 Vali Loss: 9.3659101 
EarlyStopping counter: 1 out of 7
Epoch: 47 cost time: 13.32370138168335
Epoch: 47, Steps: 54 | Train Loss: 14.4185733 Vali Loss: 9.9225762 
EarlyStopping counter: 2 out of 7
Epoch: 48 cost time: 13.57424020767212
Epoch: 48, Steps: 54 | Train Loss: 14.2953806 Vali Loss: 7.9854258 
Validation loss decreased (8.269372 --> 7.985426).  Saving model ...
Epoch: 49 cost time: 13.040695428848267
Epoch: 49, Steps: 54 | Train Loss: 14.1160204 Vali Loss: 8.6944479 
EarlyStopping counter: 1 out of 7
Epoch: 50 cost time: 13.362932443618774
Epoch: 50, Steps: 54 | Train Loss: 13.9320077 Vali Loss: 9.9892845 
EarlyStopping counter: 2 out of 7
Epoch: 51 cost time: 13.703738927841187
Epoch: 51, Steps: 54 | Train Loss: 13.8164008 Vali Loss: 8.7645482 
EarlyStopping counter: 3 out of 7
Epoch: 52 cost time: 13.128631830215454
Epoch: 52, Steps: 54 | Train Loss: 13.6403887 Vali Loss: 8.9684084 
EarlyStopping counter: 4 out of 7
Epoch: 53 cost time: 13.596930265426636
Epoch: 53, Steps: 54 | Train Loss: 13.4841204 Vali Loss: 9.6303792 
EarlyStopping counter: 5 out of 7
Epoch: 54 cost time: 13.270607948303223
Epoch: 54, Steps: 54 | Train Loss: 13.3598057 Vali Loss: 9.7343290 
EarlyStopping counter: 6 out of 7
Epoch: 55 cost time: 14.40912914276123
Epoch: 55, Steps: 54 | Train Loss: 13.1437245 Vali Loss: 8.8488342 
EarlyStopping counter: 7 out of 7
Early stopping
Training finished!
prediction:  (366275, 84)
groundtruth:  (366275, 84)
MSE: 8.846354484558105, MAE: 1.9929819107055664
Testing finished!
Spend Time:  971.4833986759186
