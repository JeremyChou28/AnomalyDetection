------------ Options -------------
batch_size: 16384
d_channel: 8
d_ff: 1024
d_model: 512
data_path: ./processed_dataset
dataset: AD
dropout: 0.1
e_layers: 1
input_c: 84
k: 0
lr: 0.001
mode: scratch
model_name: ours
model_save_path: checkpoints
n_heads: 8
num_epochs: 100
output_c: 84
seed: 2023
win_size: 1
-------------- End ----------------
train_loader len: 54
val_loader len: 14
test_loader len: 23
======================TRAIN MODE======================
Epoch: 1 cost time: 19.16655707359314
Epoch: 1, Steps: 54 | Train Loss: 5054.9496166 Vali Loss: 4626.3084891 
Validation loss decreased (inf --> 4626.308489).  Saving model ...
Epoch: 2 cost time: 15.469085931777954
Epoch: 2, Steps: 54 | Train Loss: 4149.2312509 Vali Loss: 3514.8598458 
Validation loss decreased (4626.308489 --> 3514.859846).  Saving model ...
Epoch: 3 cost time: 15.431075811386108
Epoch: 3, Steps: 54 | Train Loss: 2965.4507062 Vali Loss: 2226.5503802 
Validation loss decreased (3514.859846 --> 2226.550380).  Saving model ...
Epoch: 4 cost time: 15.340710401535034
Epoch: 4, Steps: 54 | Train Loss: 1750.3544877 Vali Loss: 1146.0713588 
Validation loss decreased (2226.550380 --> 1146.071359).  Saving model ...
Epoch: 5 cost time: 15.671193599700928
Epoch: 5, Steps: 54 | Train Loss: 875.4506067 Vali Loss: 504.5359998 
Validation loss decreased (1146.071359 --> 504.536000).  Saving model ...
Epoch: 6 cost time: 15.875814199447632
Epoch: 6, Steps: 54 | Train Loss: 398.3369254 Vali Loss: 211.9492460 
Validation loss decreased (504.536000 --> 211.949246).  Saving model ...
Epoch: 7 cost time: 15.628286600112915
Epoch: 7, Steps: 54 | Train Loss: 258.0880935 Vali Loss: 103.3243915 
Validation loss decreased (211.949246 --> 103.324392).  Saving model ...
Epoch: 8 cost time: 15.239785194396973
Epoch: 8, Steps: 54 | Train Loss: 111.2858447 Vali Loss: 53.2275301 
Validation loss decreased (103.324392 --> 53.227530).  Saving model ...
Epoch: 9 cost time: 15.31095027923584
Epoch: 9, Steps: 54 | Train Loss: 70.5800507 Vali Loss: 33.2485839 
Validation loss decreased (53.227530 --> 33.248584).  Saving model ...
Epoch: 10 cost time: 14.75509262084961
Epoch: 10, Steps: 54 | Train Loss: 51.1535488 Vali Loss: 23.4028408 
Validation loss decreased (33.248584 --> 23.402841).  Saving model ...
Epoch: 11 cost time: 18.230689525604248
Epoch: 11, Steps: 54 | Train Loss: 40.5495805 Vali Loss: 18.7468617 
Validation loss decreased (23.402841 --> 18.746862).  Saving model ...
Epoch: 12 cost time: 19.53613305091858
Epoch: 12, Steps: 54 | Train Loss: 34.2402667 Vali Loss: 15.7522982 
Validation loss decreased (18.746862 --> 15.752298).  Saving model ...
Epoch: 13 cost time: 17.355540990829468
Epoch: 13, Steps: 54 | Train Loss: 30.1501591 Vali Loss: 16.0004297 
EarlyStopping counter: 1 out of 7
Epoch: 14 cost time: 19.588393926620483
Epoch: 14, Steps: 54 | Train Loss: 27.2394965 Vali Loss: 15.3210585 
Validation loss decreased (15.752298 --> 15.321058).  Saving model ...
Epoch: 15 cost time: 21.035274982452393
Epoch: 15, Steps: 54 | Train Loss: 25.1298409 Vali Loss: 14.9312788 
Validation loss decreased (15.321058 --> 14.931279).  Saving model ...
Epoch: 16 cost time: 17.817878484725952
Epoch: 16, Steps: 54 | Train Loss: 23.5312733 Vali Loss: 13.5348870 
Validation loss decreased (14.931279 --> 13.534887).  Saving model ...
Epoch: 17 cost time: 17.699411630630493
Epoch: 17, Steps: 54 | Train Loss: 22.2947880 Vali Loss: 15.7214063 
EarlyStopping counter: 1 out of 7
Epoch: 18 cost time: 16.879557609558105
Epoch: 18, Steps: 54 | Train Loss: 21.0684836 Vali Loss: 13.8619552 
EarlyStopping counter: 2 out of 7
Epoch: 19 cost time: 16.71895146369934
Epoch: 19, Steps: 54 | Train Loss: 20.3151403 Vali Loss: 12.7805307 
Validation loss decreased (13.534887 --> 12.780531).  Saving model ...
Epoch: 20 cost time: 16.46709156036377
Epoch: 20, Steps: 54 | Train Loss: 19.3112291 Vali Loss: 12.8715779 
EarlyStopping counter: 1 out of 7
Epoch: 21 cost time: 16.60709047317505
Epoch: 21, Steps: 54 | Train Loss: 18.1343294 Vali Loss: 14.4121323 
EarlyStopping counter: 2 out of 7
Epoch: 22 cost time: 16.174530506134033
Epoch: 22, Steps: 54 | Train Loss: 17.5397351 Vali Loss: 12.4266516 
Validation loss decreased (12.780531 --> 12.426652).  Saving model ...
Epoch: 23 cost time: 16.249332189559937
Epoch: 23, Steps: 54 | Train Loss: 16.8893460 Vali Loss: 12.2196678 
Validation loss decreased (12.426652 --> 12.219668).  Saving model ...
Epoch: 24 cost time: 16.60562515258789
Epoch: 24, Steps: 54 | Train Loss: 16.4020371 Vali Loss: 11.8736435 
Validation loss decreased (12.219668 --> 11.873643).  Saving model ...
Epoch: 25 cost time: 16.626253604888916
Epoch: 25, Steps: 54 | Train Loss: 15.9445945 Vali Loss: 11.9584556 
EarlyStopping counter: 1 out of 7
Epoch: 26 cost time: 16.444025993347168
Epoch: 26, Steps: 54 | Train Loss: 15.4391880 Vali Loss: 12.2434314 
EarlyStopping counter: 2 out of 7
Epoch: 27 cost time: 17.37718915939331
Epoch: 27, Steps: 54 | Train Loss: 15.0932825 Vali Loss: 11.9895301 
EarlyStopping counter: 3 out of 7
Epoch: 28 cost time: 16.958674907684326
Epoch: 28, Steps: 54 | Train Loss: 14.6811636 Vali Loss: 12.9763601 
EarlyStopping counter: 4 out of 7
Epoch: 29 cost time: 17.106930255889893
Epoch: 29, Steps: 54 | Train Loss: 14.3136789 Vali Loss: 12.6909050 
EarlyStopping counter: 5 out of 7
Epoch: 30 cost time: 16.751359701156616
Epoch: 30, Steps: 54 | Train Loss: 13.9439942 Vali Loss: 12.2842816 
EarlyStopping counter: 6 out of 7
Epoch: 31 cost time: 15.654812097549438
Epoch: 31, Steps: 54 | Train Loss: 13.5087830 Vali Loss: 13.1181352 
EarlyStopping counter: 7 out of 7
Early stopping
Training finished!
prediction:  (366275, 84)
groundtruth:  (366275, 84)
MSE: 13.415985107421875, MAE: 2.4210081100463867
Testing finished!
Spend Time:  659.0447280406952
