------------ Options -------------
batch_size: 16384
d_channel: 8
d_ff: 1024
d_model: 128
data_path: ./processed_dataset
dataset: AD
dropout: 0.1
e_layers: 2
input_c: 84
k: 0
lr: 0.001
mode: scratch
model_name: ours
model_save_path: checkpoints
n_heads: 4
num_epochs: 100
output_c: 84
seed: 2023
win_size: 1
-------------- End ----------------
train_loader len: 54
val_loader len: 14
test_loader len: 23
======================TRAIN MODE======================
Epoch: 1 cost time: 16.74820613861084
Epoch: 1, Steps: 54 | Train Loss: 5211.6371889 Vali Loss: 5006.7819475 
Validation loss decreased (inf --> 5006.781948).  Saving model ...
Epoch: 2 cost time: 14.586543083190918
Epoch: 2, Steps: 54 | Train Loss: 4762.9277434 Vali Loss: 4452.0726144 
Validation loss decreased (5006.781948 --> 4452.072614).  Saving model ...
Epoch: 3 cost time: 14.569078922271729
Epoch: 3, Steps: 54 | Train Loss: 4145.5304317 Vali Loss: 3781.7275914 
Validation loss decreased (4452.072614 --> 3781.727591).  Saving model ...
Epoch: 4 cost time: 14.556062459945679
Epoch: 4, Steps: 54 | Train Loss: 3456.3469690 Vali Loss: 3054.8760289 
Validation loss decreased (3781.727591 --> 3054.876029).  Saving model ...
Epoch: 5 cost time: 14.204817295074463
Epoch: 5, Steps: 54 | Train Loss: 2719.2061858 Vali Loss: 2304.0449044 
Validation loss decreased (3054.876029 --> 2304.044904).  Saving model ...
Epoch: 6 cost time: 14.36910891532898
Epoch: 6, Steps: 54 | Train Loss: 2016.6422752 Vali Loss: 1655.8263027 
Validation loss decreased (2304.044904 --> 1655.826303).  Saving model ...
Epoch: 7 cost time: 14.562933921813965
Epoch: 7, Steps: 54 | Train Loss: 1437.5174945 Vali Loss: 1140.8852626 
Validation loss decreased (1655.826303 --> 1140.885263).  Saving model ...
Epoch: 8 cost time: 13.912013053894043
Epoch: 8, Steps: 54 | Train Loss: 982.2669113 Vali Loss: 750.6559099 
Validation loss decreased (1140.885263 --> 750.655910).  Saving model ...
Epoch: 9 cost time: 14.52812123298645
Epoch: 9, Steps: 54 | Train Loss: 646.3869476 Vali Loss: 473.2160470 
Validation loss decreased (750.655910 --> 473.216047).  Saving model ...
Epoch: 10 cost time: 13.975135087966919
Epoch: 10, Steps: 54 | Train Loss: 415.2200063 Vali Loss: 297.1196987 
Validation loss decreased (473.216047 --> 297.119699).  Saving model ...
Epoch: 11 cost time: 14.55069375038147
Epoch: 11, Steps: 54 | Train Loss: 269.6238076 Vali Loss: 185.0426341 
Validation loss decreased (297.119699 --> 185.042634).  Saving model ...
Epoch: 12 cost time: 13.965471982955933
Epoch: 12, Steps: 54 | Train Loss: 179.4132224 Vali Loss: 119.7181816 
Validation loss decreased (185.042634 --> 119.718182).  Saving model ...
Epoch: 13 cost time: 14.83114767074585
Epoch: 13, Steps: 54 | Train Loss: 124.3244127 Vali Loss: 82.1018818 
Validation loss decreased (119.718182 --> 82.101882).  Saving model ...
Epoch: 14 cost time: 14.813087463378906
Epoch: 14, Steps: 54 | Train Loss: 89.2254497 Vali Loss: 53.7364627 
Validation loss decreased (82.101882 --> 53.736463).  Saving model ...
Epoch: 15 cost time: 14.802465200424194
Epoch: 15, Steps: 54 | Train Loss: 67.1239959 Vali Loss: 42.7692021 
Validation loss decreased (53.736463 --> 42.769202).  Saving model ...
Epoch: 16 cost time: 14.472959280014038
Epoch: 16, Steps: 54 | Train Loss: 53.1835114 Vali Loss: 30.2598991 
Validation loss decreased (42.769202 --> 30.259899).  Saving model ...
Epoch: 17 cost time: 14.577954053878784
Epoch: 17, Steps: 54 | Train Loss: 43.3077479 Vali Loss: 22.9408470 
Validation loss decreased (30.259899 --> 22.940847).  Saving model ...
Epoch: 18 cost time: 14.68631100654602
Epoch: 18, Steps: 54 | Train Loss: 36.4324755 Vali Loss: 19.0871243 
Validation loss decreased (22.940847 --> 19.087124).  Saving model ...
Epoch: 19 cost time: 14.326648473739624
Epoch: 19, Steps: 54 | Train Loss: 31.7820888 Vali Loss: 16.6652134 
Validation loss decreased (19.087124 --> 16.665213).  Saving model ...
Epoch: 20 cost time: 14.695554971694946
Epoch: 20, Steps: 54 | Train Loss: 28.1363765 Vali Loss: 13.4040861 
Validation loss decreased (16.665213 --> 13.404086).  Saving model ...
Epoch: 21 cost time: 14.294253587722778
Epoch: 21, Steps: 54 | Train Loss: 25.4398118 Vali Loss: 11.9971042 
Validation loss decreased (13.404086 --> 11.997104).  Saving model ...
Epoch: 22 cost time: 14.51282525062561
Epoch: 22, Steps: 54 | Train Loss: 23.5235174 Vali Loss: 11.8014316 
Validation loss decreased (11.997104 --> 11.801432).  Saving model ...
Epoch: 23 cost time: 14.736480474472046
Epoch: 23, Steps: 54 | Train Loss: 22.1526017 Vali Loss: 9.8431029 
Validation loss decreased (11.801432 --> 9.843103).  Saving model ...
Epoch: 24 cost time: 14.165504932403564
Epoch: 24, Steps: 54 | Train Loss: 21.1797642 Vali Loss: 10.1931302 
EarlyStopping counter: 1 out of 7
Epoch: 25 cost time: 14.736336708068848
Epoch: 25, Steps: 54 | Train Loss: 19.8997591 Vali Loss: 11.3404248 
EarlyStopping counter: 2 out of 7
Epoch: 26 cost time: 14.195631504058838
Epoch: 26, Steps: 54 | Train Loss: 19.1177126 Vali Loss: 8.5110974 
Validation loss decreased (9.843103 --> 8.511097).  Saving model ...
Epoch: 27 cost time: 14.616319417953491
Epoch: 27, Steps: 54 | Train Loss: 18.3426666 Vali Loss: 8.9083557 
EarlyStopping counter: 1 out of 7
Epoch: 28 cost time: 14.790829181671143
Epoch: 28, Steps: 54 | Train Loss: 17.5925688 Vali Loss: 9.1202569 
EarlyStopping counter: 2 out of 7
Epoch: 29 cost time: 14.093554973602295
Epoch: 29, Steps: 54 | Train Loss: 16.9979951 Vali Loss: 7.9019119 
Validation loss decreased (8.511097 --> 7.901912).  Saving model ...
Epoch: 30 cost time: 14.681368350982666
Epoch: 30, Steps: 54 | Train Loss: 16.2709516 Vali Loss: 8.7804820 
EarlyStopping counter: 1 out of 7
Epoch: 31 cost time: 14.072743892669678
Epoch: 31, Steps: 54 | Train Loss: 15.8401598 Vali Loss: 7.3782580 
Validation loss decreased (7.901912 --> 7.378258).  Saving model ...
Epoch: 32 cost time: 14.742979288101196
Epoch: 32, Steps: 54 | Train Loss: 15.4810615 Vali Loss: 8.3966906 
EarlyStopping counter: 1 out of 7
Epoch: 33 cost time: 14.963522672653198
Epoch: 33, Steps: 54 | Train Loss: 14.9768567 Vali Loss: 8.6367911 
EarlyStopping counter: 2 out of 7
Epoch: 34 cost time: 14.877283096313477
Epoch: 34, Steps: 54 | Train Loss: 14.6065582 Vali Loss: 6.5853591 
Validation loss decreased (7.378258 --> 6.585359).  Saving model ...
Epoch: 35 cost time: 15.248758316040039
Epoch: 35, Steps: 54 | Train Loss: 14.3060826 Vali Loss: 8.0309223 
EarlyStopping counter: 1 out of 7
Epoch: 36 cost time: 14.835025787353516
Epoch: 36, Steps: 54 | Train Loss: 13.8305741 Vali Loss: 7.2019114 
EarlyStopping counter: 2 out of 7
Epoch: 37 cost time: 15.347633600234985
Epoch: 37, Steps: 54 | Train Loss: 13.5275032 Vali Loss: 6.5951609 
EarlyStopping counter: 3 out of 7
Epoch: 38 cost time: 14.864579439163208
Epoch: 38, Steps: 54 | Train Loss: 13.3186319 Vali Loss: 7.9519607 
EarlyStopping counter: 4 out of 7
Epoch: 39 cost time: 14.522438526153564
Epoch: 39, Steps: 54 | Train Loss: 13.0161668 Vali Loss: 7.0456188 
EarlyStopping counter: 5 out of 7
Epoch: 40 cost time: 14.078192472457886
Epoch: 40, Steps: 54 | Train Loss: 12.5783629 Vali Loss: 6.5842107 
Validation loss decreased (6.585359 --> 6.584211).  Saving model ...
Epoch: 41 cost time: 14.646740674972534
Epoch: 41, Steps: 54 | Train Loss: 12.2787763 Vali Loss: 8.1260898 
EarlyStopping counter: 1 out of 7
Epoch: 42 cost time: 14.052051305770874
Epoch: 42, Steps: 54 | Train Loss: 12.1006706 Vali Loss: 7.5948114 
EarlyStopping counter: 2 out of 7
Epoch: 43 cost time: 14.691510438919067
Epoch: 43, Steps: 54 | Train Loss: 11.8664181 Vali Loss: 7.7986240 
EarlyStopping counter: 3 out of 7
Epoch: 44 cost time: 14.001816511154175
Epoch: 44, Steps: 54 | Train Loss: 11.7661742 Vali Loss: 7.6317692 
EarlyStopping counter: 4 out of 7
Epoch: 45 cost time: 14.715416669845581
Epoch: 45, Steps: 54 | Train Loss: 11.5858124 Vali Loss: 7.4362922 
EarlyStopping counter: 5 out of 7
Epoch: 46 cost time: 13.986323595046997
Epoch: 46, Steps: 54 | Train Loss: 11.3717306 Vali Loss: 7.2921406 
EarlyStopping counter: 6 out of 7
Epoch: 47 cost time: 14.417775869369507
Epoch: 47, Steps: 54 | Train Loss: 11.2558428 Vali Loss: 7.7543889 
EarlyStopping counter: 7 out of 7
Early stopping
Training finished!
prediction:  (366275, 84)
groundtruth:  (366275, 84)
MSE: 7.0896453857421875, MAE: 1.8059418201446533
Testing finished!
Spend Time:  855.4036161899567
